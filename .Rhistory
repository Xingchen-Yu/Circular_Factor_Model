################################################
hn = 116
library(wnominate)
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
out = ymat_spit(hn)
ymat = out[[1]]
pol = pol_lower(pol)
sum_bill = apply(ymat,2,function(x) sum(x,na.rm = T))
dem = grep('\\(D',pol)
gop = grep('\\(R',pol)
l_dem = length(dem)
l_gop = length(gop)
#########################################
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
library(wnominate)
library(circular)
library(plotrix)
library(stringr)
pol_lower = function(x){
p_loc = str_locate(x, "\\(")[, 1]
to_lower = sapply(1:length(x),function(i) substring(x[i],2,p_loc[i]-1))
sapply(1:length(x), function(i) gsub(to_lower[i],tolower(to_lower[i]),x[i]))
}
hn = 116
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
yes_mean = apply(yes_master,1,mean.circular)
no_mean = apply(no_master,1, mean.circular)
pol[135] = "GARCIA (D IL-4)"
pol = pol_lower(pol)
out = ymat_spit(hn=hn)
if(hn==116){
print('Only session 1 (first 700 votes) of the 116 House data will be analyzed')
}
ymat = out[[1]]
table_list = apply(ymat,2,function(x) table(x,exclude = NA))
close = which(unlist(lapply(table_list,function(x) any(x/sum(x)<0.05) + length(x))==3)==T)
length(close)
plot_index = close[which(acos(cos(yes_mean[close]-no_mean[close]))>2.1)] ### 2.1
# plot_index = close[which(acos(cos(yes_mean[2,close]-no_mean[2,close]))>2.4)]
nnn = length(plot_index)
name_list = vector('list',nnn)
# names(which(Y_temp==c(0,1)[which.min(table_list[[bill_number]])]))
for(i in 1:nnn){
Y_temp = ymat[,plot_index[i]]
# check_value = c(0,1)[as.numeric(which(table(Y_temp)==min(table(Y_temp))))]
name_list[[i]] = names(which(Y_temp==c(0,1)[which.min(table_list[[plot_index[i]]])]))
}
names(name_list) = paste0('Bill ', plot_index)
name_list
library(circular)
# beta_mean = apply(beta_master,1,median)
beta_mean = apply(beta_master,1,circular::mean.circular)
names(beta_mean) = pol
yes_mean2 = apply(yes_master,1,mean.circular)
no_mean2 = apply(no_master,1,mean.circular)
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 496
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='blue',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='red',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
beta_mean
str(beta_mean)
name_list$`Bill 496`
which(names(beta_mean)==name_list$`Bill 496`)
name_list$`Bill 496`)
names(beta_mean)
name_list$`Bill 496`
name_list
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
library(wnominate)
library(circular)
library(plotrix)
library(stringr)
pol_lower = function(x){
p_loc = str_locate(x, "\\(")[, 1]
to_lower = sapply(1:length(x),function(i) substring(x[i],2,p_loc[i]-1))
sapply(1:length(x), function(i) gsub(to_lower[i],tolower(to_lower[i]),x[i]))
}
hn = 116
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
# yes_mean = apply(yes_master,1,function(x) quantile(x,probs = c(0.025,0.5,0.975)))
# no_mean = apply(no_master,1,function(x) quantile(x,probs = c(0.025,0.5,0.975)))
yes_mean = apply(yes_master,1,mean.circular)
no_mean = apply(no_master,1, mean.circular)
pol[135] = "GARCIA (D IL-4)"
pol = pol_lower(pol)
out = ymat_spit(hn=hn)
if(hn==116){
print('Only session 1 (first 700 votes) of the 116 House data will be analyzed')
}
ymat = out[[1]]
table_list = apply(ymat,2,function(x) table(x,exclude = NA))
close = which(unlist(lapply(table_list,function(x) any(x/sum(x)<0.05) + length(x))==3)==T)
length(close)
plot_index = close[which(acos(cos(yes_mean[close]-no_mean[close]))>2.1)] ### 2.1
# plot_index = close[which(acos(cos(yes_mean[2,close]-no_mean[2,close]))>2.4)]
nnn = length(plot_index)
name_list = vector('list',nnn)
name_list
# names(which(Y_temp==c(0,1)[which.min(table_list[[bill_number]])]))
for(i in 1:nnn){
Y_temp = ymat[,plot_index[i]]
# check_value = c(0,1)[as.numeric(which(table(Y_temp)==min(table(Y_temp))))]
name_list[[i]] = pol_lower(names(which(Y_temp==c(0,1)[which.min(table_list[[plot_index[i]]])])))
}
names(name_list) = paste0('Bill ', plot_index)
name_list
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 496
library(circular)
# beta_mean = apply(beta_master,1,median)
beta_mean = apply(beta_master,1,circular::mean.circular)
names(beta_mean) = pol
yes_mean2 = apply(yes_master,1,mean.circular)
no_mean2 = apply(no_master,1,mean.circular)
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 496
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
library(wnominate)
library(circular)
library(plotrix)
library(stringr)
pol_lower = function(x){
p_loc = str_locate(x, "\\(")[, 1]
to_lower = sapply(1:length(x),function(i) substring(x[i],2,p_loc[i]-1))
sapply(1:length(x), function(i) gsub(to_lower[i],tolower(to_lower[i]),x[i]))
}
hn = 116
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
# yes_mean = apply(yes_master,1,function(x) quantile(x,probs = c(0.025,0.5,0.975)))
# no_mean = apply(no_master,1,function(x) quantile(x,probs = c(0.025,0.5,0.975)))
yes_mean = apply(yes_master,1,mean.circular)
no_mean = apply(no_master,1, mean.circular)
# pol[135] = "GARCIA (D IL-4)"
pol = pol_lower(pol)
out = ymat_spit(hn=hn)
if(hn==116){
print('Only session 1 (first 700 votes) of the 116 House data will be analyzed')
}
ymat = out[[1]]
table_list = apply(ymat,2,function(x) table(x,exclude = NA))
close = which(unlist(lapply(table_list,function(x) any(x/sum(x)<0.05) + length(x))==3)==T)
length(close)
plot_index = close[which(acos(cos(yes_mean[close]-no_mean[close]))>2.1)] ### 2.1
# plot_index = close[which(acos(cos(yes_mean[2,close]-no_mean[2,close]))>2.4)]
nnn = length(plot_index)
name_list = vector('list',nnn)
for(i in 1:nnn){
Y_temp = ymat[,plot_index[i]]
# check_value = c(0,1)[as.numeric(which(table(Y_temp)==min(table(Y_temp))))]
name_list[[i]] = pol_lower(names(which(Y_temp==c(0,1)[which.min(table_list[[plot_index[i]]])])))
}
names(name_list) = paste0('Bill ', plot_index)
name_list
beta_mean = apply(beta_master,1,circular::mean.circular)
names(beta_mean) = pol
# yes_mean = apply(yes_master,1,function(x) quantile.circular(x,probs = c(0.025,0.5,0.975)))
# no_mean = apply(no_master,1,function(x) quantile.circular(x,probs = c(0.025,0.5,0.975)))
yes_mean2 = apply(yes_master,1,mean.circular)
no_mean2 = apply(no_master,1,mean.circular)
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 496
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='blue',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='red',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray38',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray38',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray88',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
plot_k = 531
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
sum_bill[order(sum_bill)]
################################################
hn = 116
library(wnominate)
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
out = ymat_spit(hn)
ymat = out[[1]]
pol = pol_lower(pol)
sum_bill = apply(ymat,2,function(x) sum(x,na.rm = T))
dem = grep('\\(D',pol)
gop = grep('\\(R',pol)
l_dem = length(dem)
l_gop = length(gop)
# ind = grep('\\(I',pol)
sum_bill_dem = apply(ymat,2,function(x) sum(x[dem],na.rm = T))
sum_bill_gop = apply(ymat,2,function(x) sum(x[gop],na.rm = T))
sum_by_party = cbind(sum_bill_dem,sum_bill_gop)
colnames(sum_by_party) = c('Dem','GOP')
diff_party = abs(apply(sum_by_party,1,diff))
bill_split_party = which(diff_party == max(diff_party))
sum_by_party[bill_split_party,]
party_n = length(bill_split_party)
sum_bill[order(sum_bill)]
una_bill = which(sum_bill==424)
una_bill
table(ymat[,32])
# table(ymat[,81])
# table(ymat[,149])
which(is.na(ymat[,32])==T)
which(ymat[,una_bill]==0)
#########################################
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
library(wnominate)
library(circular)
library(plotrix)
library(stringr)
pol_lower = function(x){
p_loc = str_locate(x, "\\(")[, 1]
to_lower = sapply(1:length(x),function(i) substring(x[i],2,p_loc[i]-1))
sapply(1:length(x), function(i) gsub(to_lower[i],tolower(to_lower[i]),x[i]))
}
hn = 116
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
yes_mean = apply(yes_master,1,mean.circular)
no_mean = apply(no_master,1, mean.circular)
# pol[135] = "GARCIA (D IL-4)"
pol = pol_lower(pol)
out = ymat_spit(hn=hn)
if(hn==116){
print('Only session 1 (first 700 votes) of the 116 House data will be analyzed')
}
ymat = out[[1]]
table_list = apply(ymat,2,function(x) table(x,exclude = NA))
close = which(unlist(lapply(table_list,function(x) any(x/sum(x)<0.05) + length(x))==3)==T)
length(close)
plot_index = close[which(acos(cos(yes_mean[close]-no_mean[close]))>2.1)] ### 2.1
# plot_index = close[which(acos(cos(yes_mean[2,close]-no_mean[2,close]))>2.4)]
nnn = length(plot_index)
name_list = vector('list',nnn)
for(i in 1:nnn){
Y_temp = ymat[,plot_index[i]]
# check_value = c(0,1)[as.numeric(which(table(Y_temp)==min(table(Y_temp))))]
name_list[[i]] = pol_lower(names(which(Y_temp==c(0,1)[which.min(table_list[[plot_index[i]]])])))
}
names(name_list) = paste0('Bill ', plot_index)
name_list
# beta_mean = apply(beta_master,1,median)
beta_mean = apply(beta_master,1,circular::mean.circular)
names(beta_mean) = pol
yes_mean2 = apply(yes_master,1,mean.circular)
no_mean2 = apply(no_master,1,mean.circular)
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 5 ## unanimous bills for h116 in paper are 5(split by party) and 32(unanimous)
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
plot_k = 32 ## unanimous bills for h116 in paper are 5(split by party) and 32(unanimous)
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
#########################################
setwd("F:/Study_Backedup/UCSC/depository/Circular_Factor_Model")
library(wnominate)
library(circular)
library(plotrix)
library(stringr)
pol_lower = function(x){
p_loc = str_locate(x, "\\(")[, 1]
to_lower = sapply(1:length(x),function(i) substring(x[i],2,p_loc[i]-1))
sapply(1:length(x), function(i) gsub(to_lower[i],tolower(to_lower[i]),x[i]))
}
hn = 112
if(hn==112){
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H112_workspace_grouped_waic_dic.Rdata")
}else{
load("F:/Study_Backedup/UCSC/LatentFactorModel/House/h116_112_tau_yes_tau_no_additional_runs/H116_workspace_grouped_waic_dic.Rdata")
}
yes_mean = apply(yes_master,1,mean.circular)
no_mean = apply(no_master,1, mean.circular)
# pol[135] = "GARCIA (D IL-4)"
pol = pol_lower(pol)
out = ymat_spit(hn=hn)
if(hn==116){
print('Only session 1 (first 700 votes) of the 116 House data will be analyzed')
}
ymat = out[[1]]
table_list = apply(ymat,2,function(x) table(x,exclude = NA))
close = which(unlist(lapply(table_list,function(x) any(x/sum(x)<0.05) + length(x))==3)==T)
length(close)
plot_index = close[which(acos(cos(yes_mean[close]-no_mean[close]))>2.1)] ### 2.1
# plot_index = close[which(acos(cos(yes_mean[2,close]-no_mean[2,close]))>2.4)]
nnn = length(plot_index)
name_list = vector('list',nnn)
# names(which(Y_temp==c(0,1)[which.min(table_list[[bill_number]])]))
for(i in 1:nnn){
Y_temp = ymat[,plot_index[i]]
# check_value = c(0,1)[as.numeric(which(table(Y_temp)==min(table(Y_temp))))]
name_list[[i]] = pol_lower(names(which(Y_temp==c(0,1)[which.min(table_list[[plot_index[i]]])])))
}
names(name_list) = paste0('Bill ', plot_index)
name_list
# bryant_yes = as.circular(yes_mean[2,],units="radians",modulo="2pi",rotation="clock")
# bryant_no = as.circular(no_mean[2,],units="radians",modulo="2pi",rotation="clock")
plot_k = 1553 ## unanimous bills for h116 in paper are 5(split by party) and 32(unanimous)
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
# beta_mean = apply(beta_master,1,median)
beta_mean = apply(beta_master,1,circular::mean.circular)
names(beta_mean) = pol
yes_mean2 = apply(yes_master,1,mean.circular)
no_mean2 = apply(no_master,1,mean.circular)
plot_k = 1553 ## unanimous bills for h116 in paper are 5(split by party) and 32(unanimous)
x11(width = 15,height=15)
bryant = circular::as.circular(as.numeric(beta_mean),units="radians",modulo="2pi",rotation="clock")
circular::plot.circular(bryant[grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray28',cex=1.5)
par(new=T)
circular::plot.circular(bryant[-grep("\\(D",pol)],shrink=1,axes=F,units="radians",zero=pi/2,col='gray68',cex=1.5,pch=17)
if(plot_k==496){
b_name = beta_mean[name_list$`Bill 496`]
}else if(plot_k==531){
b_name = beta_mean[name_list$`Bill 531`]
}else if(plot_k==1553){
b_name = beta_mean[name_list$`Bill 1553`]
}
if(plot_k %in% c(496,531,1553)){
for(jj in 1:length(b_name)){
b_name_jj = b_name[jj]
text(sin(b_name_jj),cos(b_name_jj),labels=names(b_name_jj),cex=1.5,offset = 1, font=1)
}
}
text(sin(yes_mean2[plot_k]),cos(yes_mean2[plot_k]),labels=bquote(symbol("\326")),cex=4,offset = 0, font=1)
text(sin(no_mean2[plot_k]),cos(no_mean2[plot_k]),labels=bquote("X"),cex=4,offset = 0, font=1)
